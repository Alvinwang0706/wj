var DATEVALUEDELIMITER=":";var NAMEVALUEDELIMITER=":";var SBCCASECOLON="：";var FIELDDELIMITER="|";var SBCCASEVERTICAL="｜";var RECORDDELIMITER="^";var MAXSCREENLINES=10;var MAXMEMORYPAGES=20;var BGCOLORU="FFFF00";var BGCOLORI="#00F0F0";var BGCOLORD="#778899";var MAXMENUSHORTNUM=3;var DELAY_MILLS=2000;var WINDOWSSIZE="status:no;help:0;close:0;dialogWidth:550px;dialogHeight:350px";String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};Number.prototype.toFixed=function(len){var str=this+"";var start=str.indexOf(".");if(start==-1){return Math.floor(this)}var decimal=str.split(".")[1];if(decimal&&decimal.length<=len){return Number(this)}var tempStr=str.slice(0,start+len+1);var temp=Number(tempStr.replace(".",""));if(str.substr(start+len+1,1)>=5){if(temp>0){temp=temp+1}else{temp=temp-1}}tempStr=temp+"";tempStr=tempStr.slice(0,tempStr.length-len)+"."+tempStr.slice(-len);return Number(tempStr)};function changeNumToDate(dateElement){var strDate=dateElement.value;var patrn=/^[0-9]{8}$/;if(patrn.exec(strDate)){dateElement.value=strDate.slice(0,4)+"-"+strDate.slice(4,6)+"-"+strDate.slice(6,8)}}function initElementAddOnblur(){var tFormCount=document.forms.length;for(var fm=0;fm<tFormCount;fm++){var theElements=document.forms[fm].elements;for(var i=0;i<theElements.length;i++){if(theElements[i].className&&theElements[i].className=="coolDatePicker"){var onblurName=theElements[i].attributes.onblur;if(!onblurName||!onblurName.nodeValue||onblurName.nodeValue.indexOf("changeNumToDate")==-1){theElements[i].attachEvent("onblur",function(){changeNumToDate(event.srcElement)})}else{}}}}}function checkDateByDBType(startDate,endDate,strFileName){var tSql1="select Sysvarvalue from FDSysVar where Sysvar = 'checkDBType'";var tDBTypeResult=easyExecSql(tSql1,1,0,1);if(tDBTypeResult=="1"){var interval=dateDiff(startDate,endDate,"D");var tSql2="select code2 from fdcoderela a where a.relatype='queryFileName' and a.code1='"+strFileName+"'";var tDays=easyExecSql(tSql2,1,0,1);if(tDays!=null&&tDays!=""){if(parseInt(tDays)<interval+1){alert("该时间范围数据量过大，请将时间范围控制在"+tDays+"天内！");return false}}}return true}function changeImage(image,gif){image.src=gif}function replace(strMain,strFind,strReplaceWith){var strReturn="";var intStartIndex=0,intEndIndex=0;if(strMain==null||strMain==""){return""}while((intEndIndex=strMain.indexOf(strFind,intStartIndex))>-1){strReturn=strReturn+strMain.substring(intStartIndex,intEndIndex)+strReplaceWith;intStartIndex=intEndIndex+strFind.length}strReturn=strReturn+strMain.substring(intStartIndex,strMain.length);return strReturn}function trim(s){return s.replace(/(^\s*)|(\s*$)/g,"")}function isInteger(strValue){var chkExp=/^\d+$/;return(chkExp.test(strValue))}function isNumeric(strValue){strValue=strValue.trim();if(strValue.substring(0,1)=="-"){strValue=strValue.substring(1)}var chkExp=/^\d+(\.\d+)?$/;return(chkExp.test(strValue))}function checkNumber(Field){var strValue=Field.value;if(trim(strValue)!=""&&!isNumeric(strValue)){errorMessage("请输入合法的数字");Field.focus();Field.select();return false}return true}function isCharsInBag(s,bag){var i;for(i=0;i<s.length;i++){var c=s.charAt(i);if(bag.indexOf(c)==-1){return false}}return true}function isLegalDate(y,m,d){if(isNaN(parseInt(y,10))||isNaN(parseInt(m,10))||isNaN(parseInt(d,10))){return false}var dt=new Date(parseInt(y,10),parseInt(m,10)-1,parseInt(d,10));if(dt.getFullYear()==parseInt(y,10)&&dt.getMonth()==parseInt(m,10)-1&&dt.getDate()==parseInt(d,10)){return true}else{return false}}function isDate(date){var r=date.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(r==null){return false}var d=new Date(r[1],r[3]-1,r[4]);return(d.getFullYear()==r[1]&&(d.getMonth()+1)==r[3]&&d.getDate()==r[4])}function compareDate(date1,date2){var strValue=date1.split("-");var date1Temp=new Date(strValue[0],strValue[1]-1,strValue[2]);strValue=date2.split("-");var date2Temp=new Date(strValue[0],strValue[1]-1,strValue[2]);if(date1Temp.getTime()==date2Temp.getTime()){return 0}else{if(date1Temp.getTime()>date2Temp.getTime()){return 1}else{return 2}}}function showPage(img,spanID){if(spanID.style.display==""){spanID.style.display="none";img.src="../common/images/butCollapse.gif"}else{spanID.style.display="";img.src="../common/images/butExpand.gif"}}function showPage2(td,spanID){if(spanID.style.display==""){spanID.style.display="none";td.all[0].src="../common/images/butCollapse.gif"}else{spanID.style.display="";td.all[0].src="../common/images/butExpand.gif"}}function openWindow(strURL,strName){var strWidth=screen.width-screen.width*0.2;var strHeight=screen.height-screen.height*0.3;var strTop=screen.height*0.1;var strLeft=screen.width*0.1;var newWindow=window.open(strURL,strName,"width="+strWidth+",height="+strHeight+",top="+strTop+",left="+strLeft+",toolbar=0,location=0,directories=0,menubar=0,scrollbars=1,resizable=1,status=0");newWindow.focus();return newWindow}function setOption(selectName,strValue){var arrayField=strValue.split("&");var i=0;fm.all(selectName).length=0;while(i<arrayField.length){var option=document.createElement("option");var arrayTemp=arrayField[i].split("=");var strFieldName=arrayTemp[0];var strFieldValue=unescape(arrayTemp[1]);option.value=strFieldName;option.text=strFieldValue;fm.all(selectName).add(option);i++}}function getDate(strDate,splitOp){if(splitOp==null){splitOp="-"}var arrDate=strDate.split(splitOp);if(arrDate[1].length==1){arrDate[1]="0"+arrDate[1]}if(arrDate[2].length==1){arrDate[2]="0"+arrDate[2]}return new Date(arrDate[0],arrDate[1]-1,arrDate[2])}function dateDiff(dateStart,dateEnd,MD){if(dateStart==""||dateEnd==""){return false}if(typeof(dateStart)=="string"){dateStart=getDate(dateStart)}if(typeof(dateEnd)=="string"){dateEnd=getDate(dateEnd)}var i;if(MD=="D"){var endD=dateEnd.getDate();var endM=dateEnd.getMonth();var endY=dateEnd.getFullYear();var startD=dateStart.getDate();var startM=dateStart.getMonth();var startY=dateStart.getFullYear();var startT=new Date(startY,startM,startD);var endT=new Date(endY,endM,endD);var diffDay=(endT.valueOf()-startT.valueOf())/86400000;return diffDay}else{var endD=dateEnd.getDate();var endM=dateEnd.getMonth();var endY=dateEnd.getFullYear();var startD=dateStart.getDate();var startM=dateStart.getMonth();var startY=dateStart.getFullYear();if(endD>=startD){return(endY-startY)*12+(endM-startM)+1}else{return(endY-startY)*12+(endM-startM)}}}function mathRound(x){var v=Math.round(x*100);v=v/100;return v}function pointTwo(s){var v=s.toString();var len=v.length;var index=v.indexOf(".");if(index==-1){v=v+".00";return v}else{if(len-index==3){return v}else{if(len-index==2){v=v+"0";return v}else{if(len-index==1){v=v+"00";return v}else{return v.substring(0,index+3)}}}}}function pointFour(s){var v=Math.round(parseFloat(s)*10000)/10000;v=v.toString();var len=v.length;var index=v.indexOf(".");if(index==-1){v=v+".0000";return v}else{if(len-index==5){return v}else{if(len-index==4){v=v+"0";return v}else{if(len-index==3){v=v+"00";return v}else{if(len-index==2){v=v+"000";return v}else{if(len-index==1){v=v+"0000";return v}else{return v.substring(0,index+5)}}}}}}}function errorMessage(strErrMsg){alert(strErrMsg)}function isDateI(date){var strValue;strValue=date.split("/");if(strValue.length!=3){return false}if(!isInteger(strValue[0])||!isInteger(strValue[1])||!isInteger(strValue[2])){return false}var intYear=eval(strValue[0]);var intMonth=eval(strValue[1]);var intDay=eval(strValue[2]);if(intYear<0||intYear>9999||intMonth<0||intMonth>12||intDay<0||intDay>31){return false}return true}function isDateN(date){var strValue;strValue=new Array();strValue[0]=date.substring(0,4);strValue[1]=date.substring(4,6);strValue[2]=date.substring(6,8);if(strValue.length!=3){return false}if(!isInteger(strValue[0])||!isInteger(strValue[1])||!isInteger(strValue[2])){return false}var intYear=eval(strValue[0]);var intMonth=eval(strValue[1]);var intDay=eval(strValue[2]);if(!isLegalDate(intYear,intMonth,intDay)){return false}return true}function getCurrentDate(splitOp){var CurrentDate="";var strURL="../common/jsp/CurrentDate.jsp";var strPara="CurFlag=CurDate";Request=new ActiveXObject("Microsoft.XMLHTTP");Request.open("POST",strURL,false);Request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");Request.send(strPara);try{CurrentDate=Request.responseText}catch(e1){alert("取服务器时间超时，请重试！");return""}if(CurrentDate==null||CurrentDate==""){alert("取服务器时间超时，请重试！");return""}if(splitOp==null||trim(splitOp)==""){return CurrentDate}CurrentDate=CurrentDate.replace("-",splitOp);CurrentDate=CurrentDate.replace("-",splitOp);return CurrentDate}function getCurrentTime(splitOp){var CurrentTime="";var strURL="../common/jsp/CurrentDate.jsp";var strPara="CurFlag=CurTime";Request=new ActiveXObject("Microsoft.XMLHTTP");Request.open("POST",strURL,false);Request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");Request.send(strPara);try{CurrentTime=Request.responseText}catch(e1){alert("取服务器时间超时，请重试！");return""}if(CurrentTime==null||CurrentTime==""){alert("取服务器时间超时，请重试！");return""}if(splitOp==null||trim(splitOp)==""){return CurrentTime}CurrentTime=CurrentTime.replace(":",splitOp);CurrentTime=CurrentTime.replace(":",splitOp);return CurrentTime}function getStr(c_Str,c_i,c_Split){var t_Str1,t_Str2,t_strOld;var i,i_Start,j_End;t_Str1=c_Str;t_Str2=c_Split;i=0;try{while(i<c_i){i_Start=t_Str1.indexOf(t_Str2,0);if(i_Start>=0){i=i+1;t_strOld=t_Str1;t_Str1=t_Str1.substring(i_Start+t_Str2.length,t_Str1.length)}else{if(i!=c_i-1){t_Str1=""}break}}if(i_Start>=0){t_Str1=t_strOld.substring(0,i_Start)}}catch(ex){t_Str1=""}return t_Str1}function getCodeType(strCode){if((strCode==null)||(strCode=="")){return"00"}else{return strCode.substring(11,13)}}function judgeCodeType(strCode,strType){if((strCode==null)||(strCode=="")||(strType==null)||(strType=="")){return false}else{return(getCodeType(strCode).compareTo(strType)==0)}}function emptyFormElements(){var formsNum=0;var elementsNum=0;for(formsNum=0;formsNum<window.document.forms.length;formsNum++){for(elementsNum=0;elementsNum<window.document.forms[formsNum].elements.length;elementsNum++){if(window.document.forms[formsNum].elements[elementsNum].type=="text"){window.document.forms[formsNum].elements[elementsNum].value=""}}}}function emptyUndefined(){var formsNum=0;var elementsNum=0;for(formsNum=0;formsNum<window.document.forms.length;formsNum++){for(elementsNum=0;elementsNum<window.document.forms[formsNum].elements.length;elementsNum++){if((window.document.forms[formsNum].elements[elementsNum].value=="undefined"||window.document.forms[formsNum].elements[elementsNum].value=="null")&&(window.document.forms[formsNum].elements[elementsNum].type=="text"||window.document.forms[formsNum].elements[elementsNum].type=="textarea")){window.document.forms[formsNum].elements[elementsNum].value=""}}}}function chooseArray(dataArray,filterArray){var arrResult=new Array();var recordNum,filterNum;try{for(recordNum=0;recordNum<dataArray.length;recordNum++){arrResult[recordNum]=new Array();for(filterNum=0;filterNum<filterArray.length;filterNum++){arrResult[recordNum].push(dataArray[recordNum][filterArray[filterNum]])}}}catch(ex){alert("chooseArray处理出现错误！")}return arrResult}function Conversion(strIn){var strOut;strOut=replace(strIn,"@@Enter","\r\n");strIn=strOut;strOut=replace(strIn,"@@DouQuot",'"');strIn=strOut;strOut=replace(strIn,"@@SinQuot","'");return strOut}function showCodeName(){var formsNum=0;var elementsNum=0;var strEvent="";var urlStr="";var sFeatures="";var strCode="";var strQueryResult="";var arrCode=null;var strCodeValue="";var cacheFlag=false;var strCodeSelect="";var win=searchMainWindow(this);if(win==false){win=this}var tForCount=window.document.forms.length;for(formsNum=0;formsNum<tForCount;formsNum++){var tEleCount=window.document.forms[formsNum].elements.length;for(elementsNum=0;elementsNum<tEleCount;elementsNum++){if(window.document.forms[formsNum].elements[elementsNum].className=="codeno"){strCodeValue=window.document.forms[formsNum].elements[elementsNum].value;if(strCodeValue==""){continue}if(window.document.forms[formsNum].elements[elementsNum].CodeData!=null){strQueryResult=window.document.forms[formsNum].elements[elementsNum].CodeData}else{strEvent=window.document.forms[formsNum].elements[elementsNum].ondblclick;strCode=new String(strEvent);strCode=strCode.substring(strCode.indexOf("showCodeList")+14);strCode=strCode.substring(0,strCode.indexOf("'"));if(win.parent.VD.gVCode.getVar(strCode)){arrCode=win.parent.VD.gVCode.getVar(strCode);cacheFlag=true}else{if(strCode=="AgentCode"||strCode=="OccupationCode9"){urlStr="../common/jsp/CodeQueryXML.jsp?codeType="+strCode+"&codeField="+strCode+"&codeConditon="+strCodeValue}else{urlStr="../common/jsp/CodeQueryXML.jsp?codeType="+strCode}Request=new ActiveXObject("Microsoft.XMLHTTP");Request.open("GET",urlStr,false);Request.send(null);try{strQueryResult=Request.responseText.trim()}catch(e1){alert("代码汉化报错："+e1.message)}}}try{if(!cacheFlag){try{arrCode=decodeEasyQueryResult(strQueryResult,0,1)}catch(ex){alert("页面缺少引用EasyQueryVer3.js")}strCodeSelect="";var arr2=new Array();var tArrLength=arrCode.length;for(i=0;i<tArrLength;i++){if(i%100==0){arr2.push(strCodeSelect);strCodeSelect=""}strCodeSelect=strCodeSelect+"<option value="+arrCode[i][0]+">"+arrCode[i][0]+"-"+arrCode[i][1]+"</option>"}arr2.push(strCodeSelect);strCodeSelect="";tArrLength=arr2.length;for(i=0;i<tArrLength;i++){strCodeSelect=strCodeSelect+arr2[i]}if(strCode=="AgentCode"||strCode=="OccupationType9"){}else{win.parent.VD.gVCode.addArrVar(strCode,"",arrCode);win.parent.VD.gVCode.addVar(strCode+"Select","",strCodeSelect)}}cacheFlag=false;tArrLength=arrCode.length;for(i=0;i<tArrLength;i++){if(strCodeValue==arrCode[i][0]){window.document.forms[formsNum].elements[elementsNum].value=arrCode[i][0];window.document.forms[formsNum].elements[elementsNum+1].value=arrCode[i][1];break}}}catch(ex){}}if(window.document.forms[formsNum].elements[elementsNum].type=="text"){window.document.forms[formsNum].elements[elementsNum].title=window.document.forms[formsNum].elements[elementsNum].value}}}}function showOneCodeName(strCode,showObjCode,showObjName){var formsNum=0;var elementsNum=0;var urlStr="";var sFeatures="";var strQueryResult="";var arrCode=null;var strCodeValue="";var cacheFlag=false;var showObjn;var showObjc;if(showObjName==null){showObjName=strCode}var tFomCount=window.document.forms.length;for(formsNum=0;formsNum<tFomCount;formsNum++){var tEleCount=window.document.forms[formsNum].elements.length;for(elementsNum=0;elementsNum<tEleCount;elementsNum++){if(window.document.forms[formsNum].elements[elementsNum].name==showObjCode){showObjc=window.document.forms[formsNum].elements[elementsNum]}if(window.document.forms[formsNum].elements[elementsNum].name==showObjName){showObjn=window.document.forms[formsNum].elements[elementsNum];break}}}if(showObjc.value!=""){var win=searchMainWindow(this);if(win==false){win=this}if(win.parent.VD.gVCode.getVar(strCode)){arrCode=win.parent.VD.gVCode.getVar(strCode);cacheFlag=true}else{urlStr="../common/jsp/CodeQueryWindow.jsp?codeType="+strCode;sFeatures="status:no;help:0;close:0;dialogWidth:150px;dialogHeight:0px;dialogLeft:-1;dialogTop:-1;resizable=1";strQueryResult=window.showModalDialog(urlStr,"",sFeatures)}try{if(!cacheFlag){try{arrCode=decodeEasyQueryResult(strQueryResult)}catch(ex){alert("页面缺少引用EasyQueryVer3.js")}strCodeSelect="";for(i=0;i<arrCode.length;i++){strCodeSelect=strCodeSelect+"<option value="+arrCode[i][0]+">";strCodeSelect=strCodeSelect+arrCode[i][0]+"-"+arrCode[i][1];strCodeSelect=strCodeSelect+"</option>"}win.parent.VD.gVCode.addArrVar(strCode,"",arrCode);win.parent.VD.gVCode.addVar(strCode+"Select","",strCodeSelect)}cacheFlag=false;for(i=0;i<arrCode.length;i++){if(showObjc.value==arrCode[i][0]){showObjn.value=arrCode[i][1]}}}catch(ex){}}}function chkIdNo(iIdNo,iBirthday,iSex){var tmpStr="";var idDate="";var tmpInt=0;var strReturn="";iIdNo=trim(iIdNo);iBirthday=trim(iBirthday);iSex=trim(iSex);if((iIdNo.length!=15)&&(iIdNo.length!=18)){strReturn="输入的身份证号位数错误";return strReturn}if(!(isDate(iBirthday))){strReturn="输入的日期格式错误";return strReturn}var arrDate=iBirthday.split("-");if(arrDate[1].length==1){arrDate[1]="0"+arrDate[1]}if(arrDate[2].length==1){arrDate[2]="0"+arrDate[2]}iBirthday=arrDate[0]+"-"+arrDate[1]+"-"+arrDate[2];if(iSex!="1"&&iSex!="2"&&iSex!="9"){strReturn="输入的性别不明确";return strReturn}if(iIdNo.length==15){tmpStr=iIdNo.substring(6,12);tmpStr="19"+tmpStr;tmpStr=tmpStr.substring(0,4)+"-"+tmpStr.substring(4,6)+"-"+tmpStr.substring(6);if(iBirthday==tmpStr){if(iSex=="1"){tmpInt=parseInt(iIdNo.substring(14));tmpInt=tmpInt%2;if(tmpInt==0){strReturn="输入的性别与身份证号的信息不一致";return strReturn}}else{if(iSex=="2"){tmpInt=parseInt(iIdNo.substring(14));tmpInt=tmpInt%2;if(tmpInt!=0){strReturn="输入的性别与身份证号的信息不一致";return strReturn}}else{strReturn="证件类型为身份证号码时，请输入确定的性别类型！";return strReturn}}}else{strReturn="输入的生日与身份证号的信息不一致";return strReturn}return strReturn}if(iIdNo.length==18){tmpStr=iIdNo.substring(6,14);tmpStr=tmpStr.substring(0,4)+"-"+tmpStr.substring(4,6)+"-"+tmpStr.substring(6);if(iBirthday==tmpStr){if(iSex=="1"){tmpInt=parseInt(iIdNo.substring(16,17));tmpInt=tmpInt%2;if(tmpInt==0){strReturn="输入的性别与身份证号的信息不一致";return strReturn}}else{if(iSex=="2"){tmpInt=parseInt(iIdNo.substring(16,17));tmpInt=tmpInt%2;if(tmpInt!=0){strReturn="输入的性别与身份证号的信息不一致";return strReturn}}else{strReturn="证件类型为身份证号码时，请输入确定的性别类型！";return strReturn}}}else{strReturn="输入的生日与身份证号的信息不一致";return strReturn}return strReturn}}function checkIdCard(idCard){var SystemDate=new Date();var year=SystemDate.getFullYear();var month=SystemDate.getMonth()+1;var day=SystemDate.getDate();var yyyy;var mm;var dd;var birthday;var sex;var id=idCard;var id_length=id.length;if(id_length==0){alert("请输入身份证号码!");return false}if(id_length!=15&&id_length!=18){alert("身份证号长度应为15位或18位！");return false}if(id_length==15){for(var i=0;i<id_length;i++){if(isNaN(idCard.charAt(i))){alert("15位身份证号中不能有字符！");return false}}yyyy="19"+id.substring(6,8);mm=id.substring(8,10);dd=id.substring(10,12);if(mm>12||mm<=0){alert("身份证号月份非法！");return false}if(dd>31||dd<=0){alert("身份证号日期非法！");return false}if((mm==4||mm==6||mm==9||mm==11)&&(dd>30)){alert("身份证号日期非法！");return false}if(mm==2){if(LeapYear(yyyy)){if(dd>29){alert("身份证号日期非法！");return false}}else{if(dd>28){alert("身份证号日期非法！");return false}}}}else{for(var i=0;i<id_length-1;i++){if(isNaN(idCard.charAt(i))){alert("身份证号中前17位中不能有字符！");return false}}if(isNaN(idCard.charAt(17))&&idCard.charAt(17)!="X"&&idCard.charAt(17)!="x"){alert("身份证校验错误，请认真检查！");return false}if(idCard.indexOf("X")>0&&idCard.indexOf("X")!=17||idCard.indexOf("x")>0&&idCard.indexOf("x")!=17){alert('身份证中"X"输入位置不正确！');return false}yyyy=id.substring(6,10);if(yyyy>year||yyyy<1900){alert("身份证号年度非法！");return false}mm=id.substring(10,12);if(mm>12||mm<=0){alert("身份证号月份非法！");return false}if(yyyy==year&&mm>month){alert("身份证号月份非法！");return false}dd=id.substring(12,14);if(dd>31||dd<=0){alert("身份证号日期非法！");return false}if((mm==4||mm==6||mm==9||mm==11)&&(dd>30)){alert("身份证号日期非法！");return false}if(mm==2){if(LeapYear(yyyy)){if(dd>29){alert("身份证号日期非法！");return false}}else{if(dd>28){alert("身份证号日期非法！");return false}}}if(yyyy==year&&mm==month&&dd>day){alert("身份证号日期非法！");return false}if(id.charAt(17)=="x"||id.charAt(17)=="X"){if("x"!=GetVerifyBit(id)&&"X"!=GetVerifyBit(id)){alert("身份证校验错误，请认真检查！");return false}}else{if(id.charAt(17)!=GetVerifyBit(id)){alert("身份证校验错误，请认真检查！");return false}}}return true}function checkIdCard2(idCard){var errMess="";var SystemDate=new Date();var year=SystemDate.getFullYear();var month=SystemDate.getMonth()+1;var day=SystemDate.getDate();var yyyy;var mm;var dd;var birthday;var sex;var id=idCard;var id_length=id.length;if(id_length==0){errMess="请输入身份证号码!";return errMess}if(id_length!=15&&id_length!=18){errMess="身份证号长度应为15位或18位！";return errMess}if(id_length==15){for(var i=0;i<id_length;i++){if(isNaN(idCard.charAt(i))){errMess="15位身份证号中不能有字符！";return errMess}}yyyy="19"+id.substring(6,8);mm=id.substring(8,10);dd=id.substring(10,12);if(mm>12||mm<=0){errMess="身份证号月份非法！";return errMess}if(dd>31||dd<=0){errMess="身份证号日期非法！";return errMess}if((mm==4||mm==6||mm==9||mm==11)&&(dd>30)){errMess="身份证号日期非法！";return errMess}if(mm==2){if(LeapYear(yyyy)){if(dd>29){errMess="身份证号日期非法！";return errMess}}else{if(dd>28){errMess="身份证号日期非法！";return errMess}}}}else{for(var i=0;i<id_length-1;i++){if(isNaN(idCard.charAt(i))){errMess="身份证号中前17位中不能有字符！";return errMess}}if(isNaN(idCard.charAt(17))&&idCard.charAt(17)!="X"&&idCard.charAt(17)!="x"){errMess="身份证校验错误，请认真检查！";return errMess}if(idCard.indexOf("X")>0&&idCard.indexOf("X")!=17||idCard.indexOf("x")>0&&idCard.indexOf("x")!=17){errMess='身份证中"X"输入位置不正确！';return errMess}yyyy=id.substring(6,10);if(yyyy>year||yyyy<1900){errMess="身份证号年度非法！";return errMess}mm=id.substring(10,12);if(mm>12||mm<=0){errMess="身份证号月份非法！";return errMess}if(yyyy==year&&mm>month){errMess="身份证号月份非法！";return errMess}dd=id.substring(12,14);if(dd>31||dd<=0){errMess="身份证号日期非法！";return errMess}if((mm==4||mm==6||mm==9||mm==11)&&(dd>30)){errMess="身份证号日期非法！";return errMess}if(mm==2){if(LeapYear(yyyy)){if(dd>29){errMess="身份证号日期非法！";return errMess}}else{if(dd>28){errMess="身份证号日期非法！";return errMess}}}if(yyyy==year&&mm==month&&dd>day){errMess="身份证号日期非法！";return errMess}if(id.charAt(17)=="x"||id.charAt(17)=="X"){if("x"!=GetVerifyBit(id)&&"X"!=GetVerifyBit(id)){errMess="身份证校验错误，请认真检查！";return errMess}}else{if(id.charAt(17)!=GetVerifyBit(id)){errMess="身份证校验错误，请认真检查！";return errMess}}}return errMess}function GetVerifyBit(id){var result;var nNum=eval(id.charAt(0)*7+id.charAt(1)*9+id.charAt(2)*10+id.charAt(3)*5+id.charAt(4)*8+id.charAt(5)*4+id.charAt(6)*2+id.charAt(7)*1+id.charAt(8)*6+id.charAt(9)*3+id.charAt(10)*7+id.charAt(11)*9+id.charAt(12)*10+id.charAt(13)*5+id.charAt(14)*8+id.charAt(15)*4+id.charAt(16)*2);nNum=nNum%11;switch(nNum){case 0:result="1";break;case 1:result="0";break;case 2:result="X";break;case 3:result="9";break;case 4:result="8";break;case 5:result="7";break;case 6:result="6";break;case 7:result="5";break;case 8:result="4";break;case 9:result="3";break;case 10:result="2";break}return result}function LeapYear(intYear){if(intYear%100==0){if(intYear%400==0){return true}}else{if((intYear%4)==0){return true}}return false}function getBirthdatByIdNo(iIdNo){var tmpStr="";var idDate="";var tmpInt=0;var strReturn="";iIdNo=trim(iIdNo);if((iIdNo.length!=15)&&(iIdNo.length!=18)){strReturn="输入的身份证号位数错误";return strReturn}if(iIdNo.length==15){tmpStr=iIdNo.substring(6,12);tmpStr="19"+tmpStr;tmpStr=tmpStr.substring(0,4)+"-"+tmpStr.substring(4,6)+"-"+tmpStr.substring(6);return tmpStr}else{tmpStr=iIdNo.substring(6,14);tmpStr=tmpStr.substring(0,4)+"-"+tmpStr.substring(4,6)+"-"+tmpStr.substring(6);return tmpStr}}function CheckAppAge(birthday){var i=calAge(birthday);if(i>=151||i<=17){return false}else{return true}}function CheckAge(birthday){var i=calAge(birthday);if(i>150||i<0){return false}else{return true}}function calAge(birthday){var arrBirthday=birthday.split("-");if(arrBirthday.length==1){if(arrBirthday[0].length!=8){return""}var arrBirthdays=new Array();arrBirthdays[0]=arrBirthday[0].substring(0,4);arrBirthdays[1]=arrBirthday[0].substring(4,6);arrBirthdays[2]=arrBirthday[0].substring(6,8);var today=new Date();var arrToday=new Array();arrToday[0]=today.getFullYear();arrToday[1]=today.getMonth()+1;arrToday[2]=today.getDate();var age=arrToday[0]-arrBirthdays[0]-1;if(arrToday[1]>arrBirthdays[1]){age=age+1;return age}else{if(arrToday[1]<arrBirthdays[1]){return age}else{if(arrToday[2]>arrBirthdays[2]){age=age+1;return age}else{return age}}}}else{if(arrBirthday[1].length==1){arrBirthday[1]="0"+arrBirthday[1]}if(arrBirthday[2].length==1){arrBirthday[2]="0"+arrBirthday[2]}var today=new Date();var arrToday=new Array();arrToday[0]=today.getFullYear();arrToday[1]=today.getMonth()+1;arrToday[2]=today.getDate();var age=arrToday[0]-arrBirthday[0]-1;if(arrToday[1]>arrBirthday[1]){age=age+1;return age}else{if(arrToday[1]<arrBirthday[1]){return age}else{if(arrToday[2]>arrBirthday[2]){age=age+1;return age}else{return age}}}}}function calAgeNew(birthday,applyday){var arrBirthday=birthday.split("-");var arrApplyday=applyday.split("-");if(arrBirthday.length==1&&arrApplyday.length==1){if(arrBirthday[0].length!=8||arrApplyday[0].length!=8){return""}var arrBirthdays=new Array();arrBirthdays[0]=arrBirthday[0].substring(0,4);arrBirthdays[1]=arrBirthday[0].substring(4,6);arrBirthdays[2]=arrBirthday[0].substring(6,8);var arrToday=new Array();arrToday[0]=arrApplyday[0].substring(0,4);arrToday[1]=arrApplyday[0].substring(4,6);arrToday[2]=arrApplyday[0].substring(6,8);var age=arrToday[0]-arrBirthdays[0]-1;if(arrToday[1]>arrBirthdays[1]){age=age+1;return age}else{if(arrToday[1]<arrBirthdays[1]){return age}else{if(arrToday[2]>=arrBirthdays[2]){age=age+1;return age}else{return age}}}}else{if(arrBirthday.length==1&&arrApplyday.length!=1){if(arrBirthday[0].length!=8){return""}var arrBirthdays=new Array();arrBirthdays[0]=arrBirthday[0].substring(0,4);arrBirthdays[1]=arrBirthday[0].substring(4,6);arrBirthdays[2]=arrBirthday[0].substring(6,8);if(arrApplyday[1].length==1){arrApplyday[1]="0"+arrApplyday[1]}if(arrApplyday[2].length==1){arrApplyday[2]="0"+arrApplyday[2]}var arrToday=new Array();arrToday[0]=arrApplyday[0];arrToday[1]=arrApplyday[1];arrToday[2]=arrApplyday[2];var age=arrToday[0]-arrBirthdays[0]-1;if(arrToday[1]>arrBirthdays[1]){age=age+1;return age}else{if(arrToday[1]<arrBirthdays[1]){return age}else{if(arrToday[2]>=arrBirthdays[2]){age=age+1;return age}else{return age}}}}else{if(arrBirthday.length!=1&&arrApplyday.length==1){if(arrApplyday[0].length!=8){return""}if(arrBirthday[1].length==1){arrBirthday[1]="0"+arrBirthday[1]}if(arrBirthday[2].length==1){arrBirthday[2]="0"+arrBirthday[2]}var arrToday=new Array();arrToday[0]=arrApplyday[0].substring(0,4);arrToday[1]=arrApplyday[0].substring(4,6);arrToday[2]=arrApplyday[0].substring(6,8);var age=arrToday[0]-arrBirthday[0]-1;if(arrToday[1]>arrBirthday[1]){age=age+1;return age}else{if(arrToday[1]<arrBirthday[1]){return age}else{if(arrToday[2]>=arrBirthday[2]){age=age+1;return age}else{return age}}}}else{if(arrBirthday.length!=1&&arrApplyday.length!=1){if(arrBirthday[1].length==1){arrBirthday[1]="0"+arrBirthday[1]}if(arrBirthday[2].length==1){arrBirthday[2]="0"+arrBirthday[2]}if(arrApplyday[1].length==1){arrApplyday[1]="0"+arrApplyday[1]}if(arrApplyday[2].length==1){arrApplyday[2]="0"+arrApplyday[2]}var arrToday=new Array();arrToday[0]=arrApplyday[0];arrToday[1]=arrApplyday[1];arrToday[2]=arrApplyday[2];var age=arrToday[0]-arrBirthday[0]-1;if(arrToday[1]>arrBirthday[1]){age=age+1;return age}else{if(arrToday[1]<arrBirthday[1]){return age}else{if(arrToday[2]>=arrBirthday[2]){age=age+1;return age}else{return age}}}}}}}}function searchMainWindow(win){if(typeof(win)!="object"){return false}if(win.top.name=="FH"){return win.top}return searchMainWindow(win.top.opener)}function verifyTempfeeNo(tempfeeNo){var tSql="select Sysvarvalue from LDSysVar where Sysvar='CheckNewType'";var tResult=easyExecSql(tSql,1,0,1);if(tResult=="1"||tResult=="3"){var strSql="select CertifyCode from LZCardTrack where Startno<='"+tempfeeNo+"' and Endno>='"+tempfeeNo+"' and Receivecom = 'D"+fm.all("AgentCode").value+"' and StateFlag='0' and CertifyCode in(select CertifyCode from LMCertifyDes where CertifyClass2 = '0')";var strResult=easyQueryVer3(strSql,1,0,1);if(!strResult){alert("该单证（单证编码为："+tempfeeNo+" ）没有发放给该销售人员（"+fm.all("AgentCode").value+"）!");return false}}return true}function verifyPrtNo(prtNo){var tSql="select Sysvarvalue from LDSysVar where Sysvar='CheckNewType'";var tResult=easyExecSql(tSql,1,0,1);if(tResult=="2"||tResult=="3"){var strSql="select CertifyCode from LZCardTrack where Startno<='"+prtNo+"' and Endno>='"+prtNo+"' and Receivecom = 'D"+fm.all("AgentCode").value+"' and StateFlag='0'";var strResult=easyQueryVer3(strSql,1,0,1);if(!strResult){alert("该单证（单证编码为："+prtNo+" ）没有发放给该销售人员（"+fm.all("AgentCode").value+"）!");return false}}return true}function showTitle(){var formsNum=0;var elementsNum=0;var strEvent="";var urlStr="";var sFeatures="";var strCode="";var strQueryResult="";var arrCode=null;var strCodeValue="";var cacheFlag=false;var strCodeSelect="";var win=searchMainWindow(this);if(win==false){win=this}var tFormCount=window.document.forms.length;for(formsNum=0;formsNum<tFormCount;formsNum++){var tEleCount=window.document.forms[formsNum].elements.length;for(elementsNum=0;elementsNum<tEleCount;elementsNum++){if(window.document.forms[formsNum].elements[elementsNum].className=="code"){strCodeValue=window.document.forms[formsNum].elements[elementsNum].value;if(strCodeValue==""){continue}}if(window.document.forms[formsNum].elements[elementsNum].type=="text"){window.document.forms[formsNum].elements[elementsNum].title=window.document.forms[formsNum].elements[elementsNum].value}}}}function myonfocus(show){if(show!=null){try{show.focus()}catch(ex){show=null}}}function initElementtype(){var tFormCount=document.forms.length;for(var fm=0;fm<tFormCount;fm++){var theElements=document.forms[fm].elements;for(var i=0;i<theElements.length;i++){if(theElements[i].elementtype&&theElements[i].elementtype.indexOf("nacessary")!=-1){theElements[i].insertAdjacentHTML("afterEnd","<font id='"+theElements[i].name+"n' color=red>&nbsp;*</font>")}if(theElements[i].elementtype&&theElements[i].elementtype.indexOf("misty")!=-1){theElements[i].insertAdjacentHTML("afterEnd","<font color=red>&nbsp;?</font>")}if(theElements[i].readOnly){theElements[i].tabIndex=-1}}}initElementAddOnblur()}function getSexByIDNo(iIdNo){var tSex="";var strReturn="";if((iIdNo.length!=15)&&(iIdNo.length!=18)){strReturn="输入的身份证号位数错误";return strReturn}var tmpInt=0;if(iIdNo.length==15){tmpInt=parseInt(iIdNo.substring(14))}if(iIdNo.length==18){tmpInt=parseInt(iIdNo.substring(16,17))}tmpInt=tmpInt%2;if(tmpInt==0){tSex="1"}else{tSex="0"}return tSex}function OpenWindowNew(strurl,windowname,opentype,width,height){if(opentype=="left"){window.open(strurl,windowname,"width="+screen.availWidth+",height="+screen.availHeight+",top=0,left=0,toolbar=0,location=0,directories=0,menubar=0,scrollbars=1,resizable=1,status=0")}if(width=="undefined"||width==null){width=800}if(height=="undefined"||height==null){height=500}if(opentype=="middle"){var iWidth=width;var iHeight=height;var iTop=(window.screen.height-iHeight)/2;var iLeft=(window.screen.width-iWidth)/2;window.open(strurl,windowname,"width="+iWidth+",height="+iHeight+",top="+iTop+",left="+iLeft+",toolbar=0,location=0,directories=0,menubar=0,scrollbars=1,resizable=1,status=0")}}function modifydate(strDate){var stadate;if(strDate!=""){if(!isDate(strDate)){var year=strDate.substring(0,4);var month=strDate.substring(4,6);var day=strDate.substring(6);stadate=year+"-"+month+"-"+day}else{stadate=strDate}return stadate}}function getfullphone(phoneno){var arrphone=new Array();arrphone[0]="86";arrphone[1]="";arrphone[2]="";arrphone[3]="";if(phoneno!=""){arrphone[1]=phoneno.substring(0,phoneno.indexOf("-"));if(phoneno.indexOf("-")==phoneno.lastIndexOf("-")){arrphone[2]=phoneno.substring(phoneno.indexOf("-")+1,phoneno.length);arrphone[3]=""}else{arrphone[2]=phoneno.substring(phoneno.indexOf("-")+1,phoneno.lastIndexOf("-"));arrphone[3]=phoneno.substring(phoneno.lastIndexOf("-")+1,phoneno.length)}}return arrphone}ToolTipGlobal={id:0,getId:function(o){this.all[this.all.length]=o;return this.id++},all:[]};function ToolTip(defaultOpacity,font,BGround,color,border,offsetOn,offsetOff){this.id=ToolTipGlobal.getId(this);this.defaultOpacity=defaultOpacity;this.opacity=defaultOpacity;this.font=font;this.BGround=BGround;this.border=border;this.timerOn=null;this.timerOff=null;this.offsetOn=offsetOn;this.offsetOff=offsetOff;this.control=null;var o=this}ToolTip.prototype.fadeOn=function(){window.clearTimeout(this.timerOff);this.timerOn=window.setTimeout("ToolTipGlobal.all["+this.id+"].fade(1)",this.offsetOn[1])};ToolTip.prototype.fadeOff=function(){window.clearTimeout(this.timerOn);this.timerOff=window.setTimeout("ToolTipGlobal.all["+this.id+"].fade(0)",this.offsetOff[1])};ToolTip.prototype.setOpacity=function(x){this.opacity=x;this.control.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+x+") progid:DXImageTransform.Microsoft.Shadow(color='#FF444444', Direction=135, Strength=3)"};ToolTip.prototype.fade=function(x){var o=this.control;var ox=this.opacity;if(x){if(ox+this.offsetOn[0]<100){this.setOpacity(ox+this.offsetOn[0]);this.fadeOn()}else{this.setOpacity(100)}}else{if(ox-this.offsetOff[0]>this.defaultOpacity){this.setOpacity(ox-this.offsetOn[0]);this.fadeOff()}else{this.setOpacity(this.defaultOpacity);o.style.visibility="hidden"}}};ToolTip.prototype.setup=function(){var o=document.createElement("div");var oThis=this;with(o.style){position="absolute";top="0px";left="0px";font=this.font;zIndex=99999;background=this.BGround;color=this.color;border=this.border;padding="2px 4px";visibility="hidden"}document.body.appendChild(o);this.control=o;document.attachEvent("onmouseover",function(){var e=window.event.srcElement;if(e!=null&&e.title!=""){e.tip=e.title;e.title=""}if(e!=null&&typeof(e.tip)!="undefined"&&e.tip!=null){o.innerHTML=e.tip;oThis.setOpacity(oThis.defaultOpacity);var x,y,docheight,docwidth,dh,dw;x=window.event.clientX+document.body.scrollLeft;y=window.event.clientY+document.body.scrollTop;docheight=document.body.clientHeight;docwidth=document.body.clientWidth;dh=(o.offsetHeight+y)-docheight;dw=(o.offsetWidth+x)-docwidth;if(dw>0){o.style.left=x}else{o.style.left=x}if(dh>0){o.style.top=y-5}else{o.style.top=y+10}o.style.visibility="visible";oThis.fadeOn()}});document.attachEvent("onmouseout",function(){var e=window.event.srcElement;if(e!=null&&typeof(e.tip)!="undefined"&&e.tip!=null){o.style.visibility="hidden"}})};var tooltip=new ToolTip(20,"9pt Arial 宋体","#ffffdd","#000000","1px solid #000000",[8,20],[8,20]);function setEnable(elementID,mills){try{if(mills==null||mills==""){mills=DELAY_MILLS}setTimeout("enableButton('"+elementID+"')",mills)}catch(ex){}}function enableButton(elementID){try{document.getElementById(elementID).disabled=false}catch(ex){}}function getChnMoney(value){var intFen,i;var strArr,strCheck,strFen,strDW,strNum,strBig,strNow;if(trim(value)==""){return"零"}if(isNaN(value)){strErr="数据"+value+"非法！";alert(strErr);return""}strCheck=value+".";strArr=strCheck.split(".");strCheck=strArr[0];if(strCheck.length>12){strErr="数据"+value+"过大，无法处理！";alert(strErr);return""}try{i=0;strBig="";intFen=value*100;strFen=intFen.toString();strArr=strFen.split(".");strFen=strArr[0];intFen=strFen.length;strArr=strFen.split("");while(intFen!=0){i=i+1;switch(i){case 1:strDW="分";break;case 2:strDW="角";break;case 3:strDW="元";break;case 4:strDW="拾";break;case 5:strDW="佰";break;case 6:strDW="仟";break;case 7:strDW="万";break;case 8:strDW="拾";break;case 9:strDW="佰";break;case 10:strDW="仟";break;case 11:strDW="亿";break;case 12:strDW="拾";break;case 13:strDW="佰";break;case 14:strDW="仟";break}switch(strArr[intFen-1]){case"1":strNum="壹";break;case"2":strNum="贰";break;case"3":strNum="叁";break;case"4":strNum="肆";break;case"5":strNum="伍";break;case"6":strNum="陆";break;case"7":strNum="柒";break;case"8":strNum="捌";break;case"9":strNum="玖";break;case"0":strNum="零";break}strNow=strBig.split("");if((i==1)&&(strArr[intFen-1]=="0")){strBig="整"}else{if((i==2)&&(strArr[intFen-1]=="0")){if(strBig!="整"){strBig="零"+strBig}}else{if((i==3)&&(strArr[intFen-1]=="0")){strBig="元"+strBig}else{if((i<7)&&(i>3)&&(strArr[intFen-1]=="0")&&(strNow[0]!="零")&&(strNow[0]!="元")){strBig="零"+strBig}else{if((i<7)&&(i>3)&&(strArr[intFen-1]=="0")&&(strNow[0]=="零")){}else{if((i<7)&&(i>3)&&(strArr[intFen-1]=="0")&&(strNow[0]=="元")){}else{if((i==7)&&(strArr[intFen-1]=="0")){strBig="万"+strBig}else{if((i<11)&&(i>7)&&(strArr[intFen-1]=="0")&&(strNow[0]!="零")&&(strNow[0]!="万")){strBig="零"+strBig}else{if((i<11)&&(i>7)&&(strArr[intFen-1]=="0")&&(strNow[0]=="万")){}else{if((i<11)&&(i>7)&&(strArr[intFen-1]=="0")&&(strNow[0]=="零")){}else{if((i<11)&&(i>8)&&(strArr[intFen-1]!="0")&&(strNow[0]=="万")&&(strNow[2]=="仟")){strBig=strNum+strDW+"万零"+strBig.substring(1,strBig.length)}else{if(i==11){if((strArr[intFen-1]=="0")&&(strNow[0]=="万")&&(strNow[2]=="仟")){strBig="亿零"+strBig.substring(1,strBig.length)}else{if((strArr[intFen-1]=="0")&&(strNow[0]=="万")&&(strNow[2]!="仟")){strBig="亿"+strBig.substring(1,strBig.length)}else{if((strNow[0]=="万")&&(strNow[2]=="仟")){strBig=strNum+strDW+"零"+strBig.substring(1,strBig.length)}else{if((strNow[0]=="万")&&(strNow[2]!="仟")){strBig=strNum+strDW+strBig.substring(1,strBig.length)}else{strBig=strNum+strDW+strBig}}}}}else{if((i<15)&&(i>11)&&(strArr[intFen-1]=="0")&&(strNow[0]!="零")&&(strNow[0]!="亿")){strBig="零"+strBig}else{if((i<15)&&(i>11)&&(strArr[intFen-1]=="0")&&(strNow[0]=="亿")){}else{if((i<15)&&(i>11)&&(strArr[intFen-1]=="0")&&(strNow[0]=="零")){}else{if((i<15)&&(i>11)&&(strArr[intFen-1]!="0")&&(strNow[0]=="零")&&(strNow[1]=="亿")&&(strNow[3]!="仟")){strBig=strNum+strDW+strBig.substring(1,strBig.length)}else{if((i<15)&&(i>11)&&(strArr[intFen-1]!="0")&&(strNow[0]=="零")&&(strNow[1]=="亿")&&(strNow[3]=="仟")){strBig=strNum+strDW+"亿零"+strBig.substring(2,strBig.length)}else{strBig=strNum+strDW+strBig}}}}}}}}}}}}}}}}}strFen=strFen.substring(0,intFen-1);intFen=strFen.length;strArr=strFen.split("")}return strBig}catch(err){return""}}function getNameFromLDCode(CodeType,Code){var tCodeType=CodeType.toLowerCase();var tCode=Code;if(tCode!=""&&tCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select CodeName from FDCode where CodeType='"+tCodeType+"' and Code='"+tCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return("")}else{return(arrSelected[0][0])}}else{return("")}}function unescapes(ls_string){if((ls_string.indexOf("%u")==-1)&&(ls_string.indexOf("%20")==-1)&&(ls_string.indexOf("%0D%0A")==-1)){ls_string=replace(ls_string,"@E!","\r\n");ls_string=replace(ls_string,"@SQ!","'");ls_string=replace(ls_string,"@DQ!",'"')}else{ls_string=unescape(ls_string)}return ls_string}function NullOrBlank(sVal){if(trim(sVal)==""||(trim(sVal)==null)){return true}return false}function escapes(ls_string){ls_string=replace(ls_string,"\r\n","@E!");ls_string=replace(ls_string,"'","@SQ!");ls_string=replace(ls_string,'"',"@DQ!");return ls_string}function charToNum(str){var rtnNum=0;str=String(str);var tStr=replace(str,",","");rtnNum=parseFloat(tStr);return rtnNum}function charToNum2(str){if(isNaN(str)){return 0}if(str==""){return 0}else{var rtnNum=0;str=String(str);var tStr=replace(str,",","");rtnNum=parseFloat(tStr);return rtnNum}}function charToNum3(str){if(isNaN(str)){return 0}if(str==""){return 0}var str1=String(str);if(str1.substring(0,1)=="-"){var str2=String(str1.substring(1));var rtnNum=0;var tStr=replace(str2,",","");rtnNum=parseFloat(tStr);return -rtnNum}else{var rtnNum=0;str=String(str);var tStr=replace(str,",","");rtnNum=parseFloat(tStr);return rtnNum}}function getNameByCode(returnField,tableName,fieldName,fieldValue){var strSQL="";if(fieldValue!=""&&fieldValue!=null){strSQL="select "+returnField+" from "+tableName+" where "+fieldName+" = '"+fieldValue+"'";strQueryResult=easyQueryVer3(strSQL,1,0,1);if(!strQueryResult){return("")}var arrReturn=new Array();arrReturn=decodeEasyQueryResult(strQueryResult,0,1);return arrReturn[0][0]}else{return("")}}function getNameFromLDCodeShow(CodeType,Code){var tCodeType=CodeType.toLowerCase();var tCode=Code;if(tCode!=""&&tCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select CodeName from LDCodeShow where CodeType='"+tCodeType+"' and Code='"+tCode+"' and LanguageType='"+LanguageType+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return("")}else{return(arrSelected[0][0])}}else{return("")}}function getValueFromLDUser1(UserCode){var tUserCode=UserCode;if(tUserCode!=""&&tUserCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select UserShowCode,UserName,Name1,Name2,Name3,RoleFlag from LDUser1 where 1=1 and UserCode='"+tUserCode+"' and RoleFlag in ('01','02')";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return null}else{return arrSelected}}else{return null}}function numToChar(num){var rtnStr="";rtnStr=formatNumber(num,"#,###.##");rtnStr=getInt(rtnStr);return rtnStr}function formatNumber(number,pattern){var str=number.toString();var strInt;var strFloat;var formatInt;var formatFloat;if(/\./g.test(pattern)){formatInt=pattern.split(".")[0];formatFloat=pattern.split(".")[1]}else{formatInt=pattern;formatFloat=null}if(/\./g.test(str)){if(formatFloat!=null){var tempFloat=Math.round(parseFloat("0."+str.split(".")[1])*Math.pow(10,formatFloat.length))/Math.pow(10,formatFloat.length);strInt=(Math.floor(number)+Math.floor(tempFloat)).toString();strFloat=/\./g.test(tempFloat.toString())?tempFloat.toString().split(".")[1]:"0"}else{strInt=Math.round(number).toString();strFloat="0"}}else{strInt=str;strFloat="0"}if(formatInt!=null){var outputInt="";var zero=formatInt.match(/0*$/)[0].length;var comma=null;if(/,/g.test(formatInt)){comma=formatInt.match(/,[^,]*/)[0].length-1}var newReg=new RegExp("(\\d{"+comma+"})","g");if(strInt.length<zero){outputInt=new Array(zero+1).join("0")+strInt;outputInt=outputInt.substr(outputInt.length-zero,zero)}else{outputInt=strInt}var outputInt=outputInt.substr(0,outputInt.length%comma)+outputInt.substring(outputInt.length%comma).replace(newReg,(comma!=null?",":"")+"$1");outputInt=outputInt.replace(/^,/,"");strInt=outputInt}if(formatFloat!=null){var outputFloat="";var zero=formatFloat.match(/^0*/)[0].length;if(strFloat.length<zero){outputFloat=strFloat+new Array(zero+1).join("0");var outputFloat1=outputFloat.substring(0,zero);var outputFloat2=outputFloat.substring(zero,formatFloat.length);outputFloat=outputFloat1+outputFloat2.replace(/0*$/,"")}else{outputFloat=strFloat.substring(0,formatFloat.length)}strFloat=outputFloat}else{if(pattern!=""||(pattern==""&&strFloat=="0")){strFloat=""}}return strInt+(strFloat==""?"":"."+strFloat)}function getInt(Value){var result="";var mflag=true;var m=0;m=Value.lastIndexOf(".");if(m==-1){result=Value}else{for(var i=m+1;i<=Value.length-1;i++){if(Value.charAt(i)!="0"){result=Value;mflag=false;break}}if(mflag==true){result=Value.substring(0,m)}}return result}function getNameFromLDUser(UserDescription,UserCode){var tUserDescription=UserDescription;var tUserCode=UserCode;if(tUserCode!=""&&tUserCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select UserName from LDUser where UserDescription='"+tUserDescription+"' and UserCode='"+tUserCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return("")}else{return(arrSelected[0][0])}}else{return("")}}function getNameFromLDUser1(UserDescription,UserCode){var tUserDescription=UserDescription;var tUserCode=UserCode;if(tUserCode!=""&&tUserCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select UserName from LDUser1 where UserDescription='"+tUserDescription+"' and UserCode='"+tUserCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return("")}else{return(arrSelected[0][0])}}else{return("")}}function getValueFromLDUser(UserCode,RoleFlag){var tUserCode=UserCode;var tRoleFlag=RoleFlag;if(tUserCode!=""&&tUserCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select UserShowCode,UserName,Name1,Name2,Name3,RoleFlag from LDUser where 1=1 and UserCode='"+tUserCode+"' and RoleFlag in "+tRoleFlag;var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return null}else{return arrSelected}}else{return null}}function getValueFromJCClient(ClientNo){var tClientNo=ClientNo;if(tClientNo!=""&&tClientNo!=null){var arrSelected=new Array();var strSQL="";strSQL="select ClientShowNo,ClientName,Status,RoleFlag from JCClient where 1=1 and ClientNo='"+tClientNo+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return null}else{return arrSelected}}else{return null}}function getNameFromLMRisk(RiskCode){var tRiskCode=RiskCode;if(tRiskCode!=""&&tRiskCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select RiskName from LMRisk where RiskCode='"+tRiskCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return("")}else{return(arrSelected[0][0])}}else{return("")}}function checkValueIsExsit(tableName,fieldName,fieldValue){var strSQL="";strSQL="select "+fieldName+" from "+tableName+" where "+fieldName+" = '"+fieldValue+"'";strQueryResult=easyQueryVer3(strSQL,1,0,1);if(!strQueryResult){return false}return true}function calBirthByIDNo(IDNo){var tIDNo="";if(typeof(IDNo)=="object"){tIDNo=IDNo.value}else{tIDNo=IDNo}if(!checkIdCard(tIDNo)){return""}if(tIDNo.length==15){var tBirthday=tIDNo.substring(6,12);var year="19"+tBirthday.substring(0,2);var month=tBirthday.substring(2,4);var day=tBirthday.substring(4,6);tBirthday=year+"-"+month+"-"+day;if(!checkValidDate(year,month,day)){alert("没有"+tBirthday+"这一天！");if(typeof(IDNo)=="object"){IDNo.value=""}return""}return tBirthday}if(tIDNo.length==18){var tBirthday=tIDNo.substring(6,14);var year=tBirthday.substring(0,4);var month=tBirthday.substring(4,6);var day=tBirthday.substring(6,8);tBirthday=year+"-"+month+"-"+day;if(!checkValidDate(year,month,day)){alert("没有"+tBirthday+"这一天！");if(typeof(IDNo)=="object"){IDNo.value=""}return""}return tBirthday}}function calSexByIDNo(IDNo,flag){var tIDNo="";if(typeof(IDNo)=="object"){tIDNo=IDNo.value}else{tIDNo=IDNo}if(!isValidIDNo(tIDNo)){return""}if(tIDNo.length==15){var tSex=tIDNo.substring(14,15);if(tSex=="1"||tSex=="3"||tSex=="5"||tSex=="7"||tSex=="9"){if(flag=="0"){return"1"}else{return"男性"}}if(tSex=="0"||tSex=="2"||tSex=="4"||tSex=="6"||tSex=="8"){if(flag=="0"){return"2"}else{return"女性"}}}if(tIDNo.length==18){var tSex=tIDNo.substring(16,17);if(tSex=="1"||tSex=="3"||tSex=="5"||tSex=="7"||tSex=="9"){if(flag=="0"){return"1"}else{return"男性"}}if(tSex=="0"||tSex=="2"||tSex=="4"||tSex=="6"||tSex=="8"){if(flag=="0"){return"2"}else{return"女性"}}}}function checkcode(){removeAllError();var formsNum=0;var elementsNum=0;var strEvent="";var urlStr="";var sFeatures="";var strCode="";var aCode="";var bCode="";var cCode="";var strQueryResult="";var arrCode=null;var strCodeValue="";var cacheFlag=false;var strCodeSelect="";var win=searchMainWindow(this);if(win==false){win=this}for(formsNum=0;formsNum<window.document.forms.length;formsNum++){for(elementsNum=0;elementsNum<window.document.forms[formsNum].elements.length;elementsNum++){if((window.document.forms[formsNum].elements[elementsNum].className=="code")||(window.document.forms[formsNum].elements[elementsNum].className=="codeno")){strCodeValue=window.document.forms[formsNum].elements[elementsNum].value;if(strCodeValue==""){continue}if(window.document.forms[formsNum].elements[elementsNum].CodeData!=null){strQueryResult=window.document.forms[formsNum].elements[elementsNum].CodeData;cacheFlag=false;arrCode=decodeEasyQueryResult(strQueryResult);for(var m=0;m<arrCode.length;m++){if(strCodeValue==arrCode[m][0]){cacheFlag=true;continue}}if(cacheFlag==false){alert(window.document.forms[formsNum].elements[elementsNum].title+"代码选择错误！");window.document.forms[formsNum].elements[elementsNum].focus();return false;break}}else{strEvent=window.document.forms[formsNum].elements[elementsNum].ondblclick;if(strEvent==null){continue}strCode=new String(strEvent);strCode=strCode.substring(strCode.indexOf("showCodeList")+14);aCode=strCode.substring(0,strCode.indexOf("'"));if(strCode.indexOf("null")!=-1){strCode=strCode.substring(strCode.indexOf("null")+5);bCode=strCode.substring(0,strCode.indexOf(","));strCode=strCode.substring(strCode.indexOf(",")+2);cCode=strCode.substring(0,strCode.indexOf("'"));if(bCode.indexOf("'")!=-1){bCode=bCode.substring(1,bCode.length-1)}else{bCode=eval(bCode)}if(bCode=="null"){bCode=""}if(cCode=="null"){cCode=""}}else{bCode="";cCode=""}strCode=aCode+bCode+cCode;if(win.parent.VD.gVCode.getVar(strCode)!=false){cacheFlag=false;arrCode=win.parent.VD.gVCode.getVar(strCode);for(var m=0;m<arrCode.length;m++){if(strCodeValue==arrCode[m][0]){cacheFlag=true;continue}}if(cacheFlag==false){addError(window.document.forms[formsNum].elements[elementsNum].name+"Name",window.document.forms[formsNum].elements[elementsNum].title+"代码选择错误！");window.document.forms[formsNum].elements[elementsNum].focus();return false;break}}else{continue}}}}}return true}function checkFormula(strValue){var FormulaNum="1234567890.+-*/%()";var i;if(strValue==null||strValue==""){return true}for(i=0;i<strValue.length;i++){if(FormulaNum.indexOf(strValue.charAt(i))<0){return false}}return true}function checkProjectAuthorize(ProjCode){var tProjCode=ProjCode;if(tProjCode!=null&&tProjCode!=""){var arrResult=new Array();var sql="";sql="select ClientNo from JCProjMain where ProjCode='"+tProjCode+"'";var strResult=easyQueryVer3(sql,1,0,1);arrResult=decodeEasyQueryResult(strResult);if(arrResult!=null){var tClientNo=arrResult[0][0];var tClientType=tClientNo.charAt(0);if(tClientType=="U"){var arrSelected=new Array();var strSQL="";strSQL="select * from JCGetBidSub where ProjCode='"+tProjCode+"' and RiskStat='1' ";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult);if(arrSelected==null){parent.fraInterface.focus();alert("该项目还没有中标信息,请重新输入！");return false}else{return true}}else{if(tClientType=="P"){var arrSelected=new Array();var strSQL="";strSQL="select * from JCProjAuthor where ProjCode='"+tProjCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult);if(arrSelected==null){parent.fraInterface.focus();alert("该项目还没有授权,请重新输入！");return false}else{return true}}else{parent.fraInterface.focus();alert("该项目对应的客户编号有误,请查看！");return false}}}else{parent.fraInterface.focus();alert("该项目下没有客户,请重新输入！");return false}}else{return true}}function checkProjectAuthorizeManage(ProjCode){var tProjCode=ProjCode;if(tProjCode!=null&&tProjCode!=""){var arrResult=new Array();var sql="";sql="select ClientNo from JCProjMain where ProjCode='"+tProjCode+"'";var strResult=easyQueryVer3(sql,1,0,1);arrResult=decodeEasyQueryResult(strResult);if(arrResult!=null){var tClientNo=arrResult[0][0];var tClientType=tClientNo.charAt(0);if(tClientType=="U"){var arrSelected=new Array();var strSQL="";strSQL="select * from JCProjAuthor where ProjCode='"+tProjCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);if(!strQueryResult){parent.fraInterface.focus();alert("该项目还没有授权,请重新输入！");return false}else{strSQL="select * from JCdoc where ProjCode='"+tProjCode+"' and doctypecode='0006'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);if(!strQueryResult){alert("该项目还没有保险建议书！");return false}return true}}else{if(tClientType=="P"){return true}else{parent.fraInterface.focus();alert("该项目对应的客户编号有误,请查看！");return false}}}else{parent.fraInterface.focus();alert("该项目下没有客户,请重新输入！");return false}}else{return true}}function checkProjectAuthorizeQuery(ProjCode){var tProjCode=ProjCode;if(tProjCode!=null&&tProjCode!=""){var arrSelected=new Array();var strSQL="";strSQL="select * from JCProjAuthor where ProjCode='"+tProjCode+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult);if(arrSelected==null){parent.fraInterface.focus();alert("该项目还没有授权,请重新输入！");return false}else{strSQL="select * from JCdoc where ProjCode='"+tProjCode+"' and doctypecode='0006'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);if(!strQueryResult){alert("该项目还没有保险建议书！");return false}return true}}else{return true}}function checkValidDate(year,month,day){var dt=new Date(Number(year),Number(month)-1,Number(day));if(dt.getFullYear()==Number(year)&&dt.getMonth()==Number(month)-1&&dt.getDate()==Number(day)){return true}else{return false}}function cnToEn(cnStr){var enStr="";var tempStr=cnStr;tempStr=replace(tempStr,"１","1");tempStr=replace(tempStr,"２","2");tempStr=replace(tempStr,"３","3");tempStr=replace(tempStr,"４","4");tempStr=replace(tempStr,"５","5");tempStr=replace(tempStr,"６","6");tempStr=replace(tempStr,"７","7");tempStr=replace(tempStr,"８","8");tempStr=replace(tempStr,"９","9");tempStr=replace(tempStr,"０","0");tempStr=replace(tempStr,"＋","+");tempStr=replace(tempStr,"－","-");tempStr=replace(tempStr,"＊","*");tempStr=replace(tempStr,"／","/");tempStr=replace(tempStr,"％","%");tempStr=replace(tempStr,"（","(");tempStr=replace(tempStr,"）",")");tempStr=replace(tempStr,"\r\n","");enStr=tempStr;return enStr}function compareDateI(date1,date2){var strValue=date1.split("/");var date1Temp=new Date(strValue[0],strValue[1],strValue[2]);strValue=date2.split("/");var date2Temp=new Date(strValue[0],strValue[1],strValue[2]);if(date1Temp.getTime()==date2Temp.getTime()){return 0}else{if(date1Temp.getTime()>date2Temp.getTime()){return 1}else{return 2}}}function convertDate(vDate){var strValue;var dateValue;var strDate=vDate.value;if(strDate.indexOf("/")>=0){strValue=strDate.split("/");dateValue=strValue[0]+"-"+strValue[1]+"-"+strValue[2]}else{dateValue=strDate.substring(0,4)+"-"+strDate.substring(4,6)+"-"+strDate.substring(6,8)}vDate.value=dateValue}function dateToString(d){return d.getFullYear()+"/"+(d.getMonth()<9?("0"+(d.getMonth()+1)):(d.getMonth()+1))+"/"+(d.getDate()<10?("0"+d.getDate()):d.getDate())}function decodeString(strValue){var i,i1,j,j1;var strValue;var arrField;var arrRecord;var arrCode=new Array();var t_Str;try{arrRecord=strValue.split(RECORDDELIMITER);t_Str=getStr(arrRecord[0],1,FIELDDELIMITER);if(t_Str!="0"){return false}i1=arrRecord.length;for(i=1;i<i1;i++){arrField=arrRecord[i].split(FIELDDELIMITER);j1=arrField.length;arrCode[i-1]=new Array();for(j=0;j<j1;j++){arrCode[i-1][j]=arrField[j]}}}catch(ex){return false}return arrCode}function decodeStringNoHead(strValue){var i,i1,j,j1;var strValue;var arrField;var arrRecord;var arrCode=new Array();var t_Str;if(strValue==null||strValue==""){return false}try{arrRecord=strValue.split(RECORDDELIMITER);i1=arrRecord.length;for(i=0;i<i1;i++){arrField=arrRecord[i].split(FIELDDELIMITER);j1=arrField.length;arrCode[i]=new Array();for(j=0;j<j1;j++){arrCode[i][j]=arrField[j]}}}catch(ex){return false}return arrCode}function getConcat(Field1,Field2){var tDBType=DBType;var sqlPart="";if(Field1==null||Field1==""){return sqlPart}if(Field2==null||Field2==""){return sqlPart}if(tDBType=="SQLSERVER"){sqlPart=Field1+"+"+Field2;return sqlPart}if(tDBType=="ORACLE"){sqlPart=Field1+"||"+Field2;return sqlPart}return sqlPart}function getNameFromLDCodeEx(CodeType,Code,CodeAlias){var tCodeType=CodeType.toLowerCase();var tCode=Code;if(tCode!=""&&tCode!=null){var arrSelected=new Array();var strSQL="";strSQL="select CodeName from FDCode where CodeType='"+tCodeType+"' and Code='"+tCode+"' and CodeAlias='"+CodeAlias+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult,0,1);if(arrSelected==null){return("")}else{return(arrSelected[0][0])}}else{return("")}}function getParentItemCode(ItemCode,ItemType){var tItemCode=ItemCode;var tItemType=ItemType;var arrSelected=new Array();var strSQL="";strSQL="select subflag from JTCodeList where ItemCode='"+tItemCode+"' and ItemType='"+tItemType+"'";var strQueryResult=easyQueryVer3(strSQL,1,0,1);arrSelected=decodeEasyQueryResult(strQueryResult);if(arrSelected==null){return"F"}else{if(arrSelected[0][0]=="0"){return"N"}else{return"Y"}}}function getSysdatetime(DatetimeType){var tDBType=DBType;var sqlPart="";if(DatetimeType==null||DatetimeType==""){return sqlPart}if(tDBType=="SQLSERVER"){if(DatetimeType=="0"){sqlPart="convert(char(10),getdate(),20)";return sqlPart}if(DatetimeType=="1"){sqlPart="convert(char(8),getdate(),108)";return sqlPart}}if(tDBType=="ORACLE"){if(DatetimeType=="0"){sqlPart="to_char(sysdate,'yyyy-mm-dd')";return sqlPart}if(DatetimeType=="1"){sqlPart="to_char(sysdate,'hh24:mm:ss')";return sqlPart}}return sqlPart}function getToNumber(Field1){var tDBType=DBType;var sqlPart="";if(Field1==null||Field1==""){return sqlPart}if(tDBType=="SQLSERVER"){sqlPart="cast("+Field1+" as numeric)";return sqlPart}if(tDBType=="ORACLE"){sqlPart="TO_NUMBER("+Field1+")";return sqlPart}return sqlPart}function hideOldValue(){spanOldValue.style.display="none"}function isCodeDate(date){var strValue;strValue=date.split("/");if(strValue.length!=3){return false}if(!isInteger(strValue[0])||!isInteger(strValue[1])||!isInteger(strValue[2])){return false}var intYear=eval(strValue[0]);var intMonth=eval(strValue[1]);var intDay=eval(strValue[2]);if(intYear<0||intYear>9999||intMonth<0||intMonth>12||intDay<0||intDay>31){return false}return true}function isDateObject(object){var strReturn=isDate(object.value);if(strReturn=="false"){object.value="";return false}else{object.value=strReturn;return true}}function isRat(strValue){if(isNumeric(strValue)){if(eval(strValue)>=0&&eval(strValue)<=100){return true}}return false}function isValidIDNo(tIDNo){if(tIDNo.length!=15&&tIDNo.length!=18){return false}return true}function printWindow(strURL,strWindowName){var pageWidth=screen.availWidth-10;var pageHeight=screen.availHeight-30;if(pageWidth<100){pageWidth=100}if(pageHeight<100){pageHeight=100}var newWindow=window.open(strURL,strWindowName,"width="+pageWidth+",height="+pageHeight+",top=0,left=0,toolbar=0,location=0,directories=0,menubar=0,scrollbars=1.resizable=1,status=0");newWindow.focus();return newWindow}function setEmpty(FieldName,FieldValue,isMulti){var i=0;if(!isMulti){if(fm.all(FieldName).value==""){fm.all(FieldName).value=FieldValue}}else{for(i=0;i<fm.all(FieldName).length;i++){theField=fm.all(FieldName)[i];if(trim(theField.value)==""||eval(theField.value)==0){theField.value=FieldValue}}}}function setNewCode(field){if(trim(fm.all("new"+field.name).value)==""){fm.all("new"+field.name).value=field.value}}function showImg(imgID,stl){document.all(imgID).style.display=stl}function showOldValue(oldValue,ex,ey){spanOldValue.innerHTML=oldValue;spanOldValue.style.left=ex;spanOldValue.style.top=ey;spanOldValue.style.display=""}function showPageLoc(img,spanID,focusMark){if(spanID.style.display==""){spanID.style.display="none";img.src="../common/images/butCollapse.gif"}else{spanID.style.display="";img.src="../common/images/butExpand.gif";window.location=focusMark}}function showPageOnly(img,spanID){spanID.style.display="";img.src="/Images/piccSh/butExpand.gif"}function splitField(record){var arrayField=record.split(FIELDDELIMITER);var arrayReturn=new Array();var i;for(i=0;i<arrayField.length-1;i++){var arrayNameValuePair=arrayField[i].split(NAMEVALUEDELIMITER);arrayReturn[arrayNameValuePair[0]]=arrayNameValuePair[1]}return arrayReturn}function verifyCheck(){removeAllError();var formsNum=0;var elementsNum=0;var elementName;var elementId;var NullBlank;var curElement;for(formsNum=0;formsNum<window.document.forms.length;formsNum++){for(elementsNum=0;elementsNum<window.document.forms[formsNum].elements.length;elementsNum++){curElement=window.document.forms[formsNum].elements[elementsNum];elementName=curElement.name.toUpperCase();elementId=curElement.id.toUpperCase();NullBlank=NullOrBlank(curElement.value);if(elementId.indexOf("!")!=-1){if(NullBlank){if(curElement.className=="codeno"){addError(elementName+"Name",curElement.title+"不能为空")}else{addError(elementName,curElement.title+"不能为空")}curElement.focus();return false}}if(elementId.lastIndexOf("AMT")>=0||elementId.lastIndexOf("NUM")>=0){if(!NullBlank&&!isNumeric(curElement.value)){addError(elementName,curElement.title+"输入数字有误！");curElement.focus();return false}}else{if(elementId.lastIndexOf("RAT")>=0||elementId.lastIndexOf("WGH")>=0){if(!NullBlank&&!isRat(curElement.value)){addError(elementName,curElement.title+"输入不是小于100的数字！");curElement.focus();return false}}else{if(elementId.lastIndexOf("DATE")>=0||elementId.lastIndexOf("DAY")>=0){if(!NullBlank&&isDate(curElement.value)=="false"){addError(elementName,curElement.title+"输入有误！");curElement.focus();return false}}}}}}return true}function showtitle(obj){obj.title=obj.value}function showtitleHidden(obj,aa){obj.title=aa}function fixMath(m,n,op){var a=(m+" ");var b=(n+" ");var x=1;var y=1;var c=1;if(a.indexOf(".")>0){x=Math.pow(10,a.length-a.indexOf(".")-1)}if(b.indexOf(".")>0){y=Math.pow(10,b.length-b.indexOf(".")-1)}switch(op){case"+":case"-":c=Math.max(x,y);m=Math.round(m*c);n=Math.round(n*c);break;case"*":c=x*y;m=Math.round(m*x);n=Math.round(n*y);break;case"/":c=Math.max(x,y);m=Math.round(m*c);n=Math.round(n*c);c=1;break}return eval("("+m+op+n+")/"+c)}function checkLicenseNo(sLicenseNo){if(sLicenseNo.toUpperCase()=="0"){}else{var tLicenseNo=sLicenseNo.substring(0,2);var tProvinceFull="山东绵阳广安阿坝重庆吉林山西河南广西邛崃南充万源巴中西藏河北江苏自贡泸州内江华蓥贵州陕西香港塔什凉山简阳锡林四川广元遂宁青海云南塔城台湾什邡黑龙湖北浙江崇州攀枝眉山巴音辽宁上海湖南成都绵竹达州宁夏新疆哈密澳门海南内蒙天津广东安徽福建宜宾乐山甘孜北京江西德阳资阳甘肃";if(tLicenseNo.toUpperCase()=="WJ"||tProvinceFull.indexOf(tLicenseNo)>=0){}else{var tLicen1=sLicenseNo.substring(0,1);if(!isProvinceOrOther(tLicen1)){return false}}}return true}function isProvinceOrOther(strValue){if(strValue==null||strValue==""){return false}else{var tProvince="京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼军甲空午海未北庚沈己兰辛济壬南寅广戌成辰乙丙戍申使";if(tProvince.indexOf(strValue)<0){return false}}return true}function isABC(strValue){var tABC="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var i;if(strValue==null||strValue==""){return false}for(i=0;i<strValue.length;i++){if(tABC.indexOf(strValue.charAt(i))<0){return false}}return true}function isNo(strValue){var tNo="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";var i;if(strValue==null||strValue==""){return false}for(i=0;i<strValue.length;i++){if(tNo.indexOf(strValue.charAt(i))<0){return false}}return true}function calDate(baseDate,year,month,day){var retDate="";if(isDate(baseDate)){var baseyear=(baseDate).substring(0,4);var basemonth=(baseDate).substring(5,7);var baseday=(baseDate).substring(8,10);var baseyear=charToNum(baseyear)+charToNum2(year);var basemonth=charToNum(basemonth)+charToNum2(month)-1;var baseday=charToNum(baseday)+charToNum2(day);var tDate=new Date(baseyear,basemonth,baseday);baseyear=tDate.getYear();basemonth=charToNum(tDate.getMonth())+1;baseday=tDate.getDate();if(numToChar(basemonth).length==1){basemonth="0"+basemonth}if(numToChar(baseday).length==1){baseday="0"+baseday}retDate=baseyear+"-"+basemonth+"-"+baseday}return retDate}function onKeyDown(){var blnEevntCancel=false;if(window.event&&window.event.altKey&&(window.event.keyCode==8||window.event.keyCode==37||window.event.keyCode==39)){blnEevntCancel=true}if(window.event.keyCode==8){if(window.event.srcElement.tagName.toUpperCase()=="TEXTAREA"){if(window.event.srcElement.readOnly==true){blnEevntCancel=true}}else{if(window.event.srcElement.tagName.toUpperCase()=="INPUT"&&event.srcElement.type.toUpperCase()=="TEXT"){if(window.event.srcElement.readOnly==true){blnEevntCancel=true}}else{blnEevntCancel=true}}}if(blnEevntCancel==true){window.event.cancelBubble=true;window.event.returnValue=false;return false}return true}function _checkContNo(tMasterInscom,tContNoLen){var sql="select ContNoLenMode from FDInsContNo where MasterInscom='"+tMasterInscom+"'";var result=easyQueryVer3(sql,1,0,1);var resultArr=new Array();resultArr=decodeEasyQueryResult(result,0,0);if(resultArr!=null){if(resultArr[0][0]=="01"){sql="select * from FDInsContNo where MasterInscom='"+tMasterInscom+"' and ContNoLen='"+tContNoLen+"'";result=easyQueryVer3(sql,1,0,1);if(!result){return false}}else{if(resultArr[0][0]=="02"){sql="select * from FDInsContNo where MasterInscom='"+tMasterInscom+"' and DLen<='"+tContNoLen+"' and UpLen>='"+tContNoLen+"'";result=easyQueryVer3(sql,1,0,1);if(!result){return false}}}}return true}function isNo2(strValue){var tNo="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-";var i;if(strValue==null||strValue==""){return false}for(i=0;i<strValue.length;i++){if(tNo.indexOf(strValue.toUpperCase().charAt(i))<0){return false}}return true}function checkMoney(m1,m2){if(m1<m2){alert("交费金额不能比应收总金额小！");return false}return true};